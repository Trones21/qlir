

# To Implement 
def distance_to_trendline_per_leg(...):
    df = add_leg_indexing(df, leg_id)
    df = add_distance_to_trendline(...)
    df = mark_leg_extrema(...)
    df = add_stretch_position(...)
    return df